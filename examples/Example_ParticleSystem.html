<html>
    <head>
            <script src="../Lib_2D_JS_Biirra_Base.js"></script>
            <script src="../Lib_2D_JS_Biirra_Experimental.js"></script>
    </head>
    <body>
        <canvas id="field" width="1024" height="1024"></canvas>
    </body>
    <script>

        // TODO: still happens something weird with the performance where the drawing is inconsistent.
        let canvas = document.getElementById("field");
        let ctx = canvas.getContext("2d");

        let earthImage = new Image();
        earthImage.src = "../assets/Earth1024x1024_256Frames.png"; // source: https://s3.us-east-2.amazonaws.com/singular-assets/Global/Earth1024x1024_256Frames.png

        let particleEarth = new Particle({
            context:ctx,                        // The context.
            texture:earthImage,                 // The image. May be a Image or a string of the source.
            sLocation: Vector2d.zero,           // Top right location of the selected area on the image.
            sWidth: 64,                         // The height of the selected area on the image.
            sHeight: 64,                        // The Widht of the selected area on the image.
            width: 64,                          // The width that scales the selected area.
            height: 64,                         // The height that scales the selected area.
            ticksPerFrame: 0.2,                 // Try to keep it above 0.2 for perfermance reasons. else it will stutter on the while loop.

            numberOfFrames: 16,                 // The amount of frames horizontaly on the spritesheet. Left to right.
	        numberOfRows: 16,                   // The amount of frames vertically on the spritesheet. Top to bottom.
	        loop: true,                         // The animation will start over if its finished.
            reverse: false,                     // Play the animation in reverse

            fadeOut: true,                      // particle will fade out if its time.
            fadeOutSpeed: 0.05,                 // the speed at which the particle fades out. 
            acceleration: new Vector2d(0.1, 0.05) 
        });

        let ps = new ParticleSystem({
            location: new Vector2d(canvas.width/2, canvas.height/4),    // birth location of the particles
            maxNumberOfParticles: 100,                                  // max number of particles the system can spawn at a given moment.
            spawnSpeed: 10,                                             // how many updates before it will spawn a new batch of particles.
            batchSize: 5,                                               // the amount of particles it will spawn when it is time to add particles.
            originParticle: particleEarth
        });

        loop();
        function loop () {
            ctx.clearRect(0, 0, 1024, 1024);
            ps.update();
            ps.renderChildren();
            window.requestAnimationFrame(loop);
        }        
    </script>
</html>